<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>注册</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-theme.css" rel="stylesheet">
    <link href="css/general.css" rel="stylesheet">
    <link href="css/layout.css" rel="stylesheet">
    <script src="js/jquery-3.1.1.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/jquery.validate.js"></script>
    <script src="js/registerFormValidate.js"></script>
    <style rel="stylesheet">
        .head{
            height: 70px;
            border: 1px solid rgb(224,224,224);
        }
        .registe_body{
            width:650px;
            min-height: 50px;
            margin:0 auto;
            border: 1px solid rgb(224,224,224);
        }
        .tip{
            text-align: center;
        }
    </style>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#validateCode_btn").click(function(){
                ChangeValidateCode();
            });

            $("#emailVerify_btn").click(function () {
                if($("#email").valid()){
                    sendEmailVerifyCode();
                }else {
                    alert("你的邮箱格式不合法");
                }
            });

            $("#register_btn").click(function(){
                var status = $("#register_form").valid();
                if(status){
                    register();
                }

            });

        })

        function register(){
            $.ajax({
                        type: "POST",
                        url: "/register/submit",
                        contentType: "application/json",

                        data: JSON.stringify({
                            "userId": $("#userId").val(),
                            "password": $("#passwd").val(),
                            "repeatPassword": $("#repasswd").val(),
                            "department": $("#college").val(),
                            "realName": $("#realName").val(),
                            "phoneNumber": $("#contactNumber").val(),
                            "email": $("#email").val(),
                            "role": $("#role").val(),
                            "mailVerifyCode": $("#validateCode").val(),
                        }),

                        beforeSend: function(XMLHttpRequest){
                        },

                        success: function(data){
                            var status = data.code;
                            var msg = data.msg;
                            if(status == "200")  //注册成功
                                location.assign("/successRegister.html");
                            else if(status == "201")  //邮箱验证码错误
                                $("#v_validateCode").html(msg);
                            else if(status == "500")  //服务器原因失败
                                $("#validateWarn").html("系统繁忙请稍后再试");
                            else
                                var empty = "";
                        },

                        error: function(XMLHttpRequest, textStatus) {
                        },

                        complete: function(XMLHttpRequest, textStatus){
                        }

                    });
        }

        function ChangeValidateCode() {
            $("#validateCodeImg").attr("src", $("#validateCodeImg").attr("src") + 1);
        }

        function sendEmailVerifyCode() {
            var email = $("#email").val();
            $.ajax({
                type: "GET",
                url: "/sendVerifyCodeMail?emailTo="+email,

                beforeSend: function(XMLHttpRequest){
                },

                success: function(data){
                    var status = data.code;
                    var msg = data.msg;
                    if(status == "200")
                        alert("邮件验证码已经发送到邮箱!请检查您的邮件，注意检查垃圾箱!");
                    else if(status ==  "500")
                        alert("系统繁忙请稍后再试");
                    else
                        alert("3");
                },

                error: function(XMLHttpRequest, textStatus) {
                },

                complete: function(XMLHttpRequest, textStatus){
                }

            });
        }
    </script>


</head>
<body>
<div class="head">
    <a href="index.html"><img src="imgs/top_banner.png"/></a>

</div>

<div class="mid">
    <div class="registe_body">

        <h3 style="text-align: center">新用户注册</h3>
        <div class="tip input_tip">请用户务必按照个人真实信息填写，错误信息将影响优秀论文的申请</div>
        <form class="form-horizontal" id="register_form" role="form" style="margin-top: 20px">
            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>身份:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <select class="form-control" id="role" name="role">
                        <option value="" selected="selected">请选择</option>
                        <option value="学生">学生</option>
                        <option value="学院教务员">学院教务员</option>
                    </select>

                </div>
                <div class="col-sm-3 validate_warn" id="v_role"></div>
            </div>

            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>学号/教职工号:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <input type="text" class="form-control" id="userId" name="userId" placeholder="学号/教职工号">
                </div>
                <div class="col-sm-3 validate_warn" id="v_idnumber"></div>
            </div>


            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>密码:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <input type="password" class="form-control" id="passwd" name="passwd" placeholder="密码">
                </div>
                <div class="col-sm-3 validate_warn" id="v_passwd"></div>
            </div>

            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>确认密码:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <input type="password" class="form-control" id="repasswd" name="repasswd" placeholder="确认密码">
                </div>
                <div class="col-sm-3 validate_warn" id="v_repasswd"></div>
            </div>

            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>姓名:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <input type="text" class="form-control" id="realName" name="realName" placeholder="姓名">
                </div>
                <div class="col-sm-3 validate_warn" id="v_realName"></div>
            </div>


            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>所在院系:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <select class="form-control" id="college" name="college">
                        <option value="" selected="selected">请选择</option>
                        <option value="机械科学与工程学院">机械科学与工程学院</option>
                        <option value="计算机科学与技术学院">计算机科学与技术学院</option>
                        <option value="生命科学与技术学院">生命科学与技术学院</option>
                        <option value="电气与电子工程学院">电气与电子工程学院</option>
                        <option value="材料科学与工程学院">材料科学与工程学院</option>
                        <option value="船舶与海洋工程学院">船舶与海洋工程学院</option>
                        <option value="能源与动力工程学院">能源与动力工程学院</option>
                        <option value="自动化学院">自动化学院</option>
                        <option value="光学与电子信息学院">光学与电子信息学院</option>
                        <option value="水电与数字化工程学院">水电与数字化工程学院</option>
                        <option value="软件学院">软件学院</option>
                        <option value="环境科学与工程学院">环境科学与工程学院</option>
                        <option value="电子信息与通信学院">电子信息与通信学院</option>
                        <option value="建筑与城市规划学院">建筑与城市规划学院</option>
                        <option value="土木工程与力学学院">土木工程与力学学院</option>
                        <option value="化学与化工学院">化学与化工学院</option>
                        <option value="数学与统计学院">数学与统计学院</option>
                        <option value="物理学院">物理学院</option>
                        <option value="公共管理学院">公共管理学院</option>
                        <option value="经济学院">经济学院</option>
                        <option value="管理学院">管理学院</option>
                        <option value="人文学院">人文学院</option>
                        <option value="新闻与信息传播学院">新闻与信息传播学院</option>
                        <option value="马克思主义学院">马克思主义学院</option>
                        <option value="社会学院">社会学院</option>
                        <option value="法学院">法学院</option>
                        <option value="外国语学院">外国语学院</option>
                        <option value="基础医学院（含法医学系）">基础医学院（含法医学系）</option>
                        <option value="药学院">药学院</option>
                        <option value="医药卫生管理学院">医药卫生管理学院</option>
                        <option value="公共卫生学院">公共卫生学院</option>
                        <option value="附属协和医院">附属协和医院</option>
                        <option value="附属同济医院（含附属梨园医院、计划生育研究所、护理学系）">附属同济医院（含附属梨园医院、计划生育研究所、护理学系）</option>
                        <option value="教育科学研究院">教育科学研究院</option>
                        <option value="中欧清洁与可再生能源学院">中欧清洁与可再生能源学院</option>
                        <option value="国学研究院">国学研究院</option>
                        <option value="体育部">体育部</option>
                        <option value="武汉光电国家实验室">武汉光电国家实验室</option>
                        <option value="工程科学学院">工程科学学院</option>
                        <option value="武汉国际微电子学院">武汉国际微电子学院</option>


                    </select>

                </div>
                <div class="col-sm-3 validate_warn" id="v_college"></div>
            </div>

            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>联系方式:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <input type="text" class="form-control" id="contactNumber" name="contactNumber" placeholder="联系方式">
                </div>
                <div class="col-sm-3 validate_warn" id="v_contactNumber"></div>
            </div>

            <div class="form-group">

                <div class="col-sm-3 _text_right input_tip"><label>邮箱:</label></div>
                <div class="col-sm-6" style="margin-left: -12px">
                    <input type="text" class="form-control" id="email" name="email" placeholder="邮箱">
                </div>
                <div class="col-sm-3 validate_warn" id="v_email"></div>
            </div>

            <div class="form-group">
                <div class="col-sm-3 _text_right input_tip"><label>邮箱验证码:</label></div>
                <div class="col-sm-3" style="margin-left: -12px">
                    <input type="text" class="form-control" id="validateCode" name="validateCode" placeholder="邮箱验证码">
                </div>
                <div class="col-sm-3 validate_warn">
                    <button type="button" id="emailVerify_btn" class="btn btn-default">发送邮箱验证码</button>
                </div>
                <div class="col-sm-3 validate_warn" id="v_validateCode">
                </div>
            </div>

            <div class="form-group" style="margin-top: 30px">
                <div class="col-sm-offset-3 col-sm-6">
                    <button type="button" id="register_btn" class="btn btn-primary btn-lg btn-block">注册</button>
                </div>
            </div>

        </form>

    </div>
</div>

<div class="foot">
    <div class="row center">
        <a href="http://www.hust.edu.cn" target="_blank">华中科技大学</a> |
        <a href="http://gs.hust.edu.cn/" target="_blank">研究生院</a> |
        <a href="http://www.lib.hust.edu.cn/" target="_blank">图书馆</a> |
        <a href="http://xsyj.hust.edu.cn/" target="_blank">校史馆</a> |
        <a href="http://student.ehust.net/" target="_blank">学工在线</a> |
        <a href="http://www.hustonline.net/" target="_blank">华中大在线</a>
    </div>
    <div class="row center">
        ©2017 华中科技大学研究生院 版权所有
    </div>
</div>

</body>
</html>